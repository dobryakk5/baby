# Excel –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è Telegram –±–æ—Ç–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ñ–µ—Ä—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

## –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–º–ø–æ—Ä—Ç–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ñ–µ—Ä—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ Excel —Ñ–∞–π–ª—ã –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π Telegram –±–æ—Ç.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`excel_data_handler.py`** - –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏
2. **`fertility_excel_bot_integration.py`** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Excel —Ñ—É–Ω–∫—Ü–∏–π —Å Telegram –±–æ—Ç–æ–º
3. **`updated_fertility_bot.py`** - –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–æ—Ç–∞ —Å Excel –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–æ–ª—è Excel

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã –≤ Excel —Ñ–∞–π–ª–∞—Ö:

| –°—Ç–æ–ª–±–µ—Ü | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö |
|---------|----------|------------|
| `–î–µ–Ω—å —Ü–∏–∫–ª–∞` | –ù–æ–º–µ—Ä –¥–Ω—è –≤ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–º —Ü–∏–∫–ª–µ | –ß–∏—Å–ª–æ (1-40) |
| `–î–∞—Ç–∞` | –î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏ | –ß–∏—Å–ª–æ/–î–∞—Ç–∞ |
| `–ë–¢–¢` | –ë–∞–∑–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞ | –ß–∏—Å–ª–æ (35.0-40.0¬∞C) |
| `—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞.1` | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ | –ß–∏—Å–ª–æ (35.0-40.0¬∞C) |
| `–ù–∞—Ä—É—à–µ–Ω–∏—è` | –ö–æ–¥—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π –∏–∑–º–µ—Ä–µ–Ω–∏—è | –¢–µ–∫—Å—Ç |
| `–ù–¢` | –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –∫–æ–¥—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π | –¢–µ–∫—Å—Ç |
| `–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ` | –ó–∞–º–µ—Ç–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –¢–µ–∫—Å—Ç |
| `–ù–æ–≤—ã–π —Ç–µ—Ä–º–æ–º–µ—Ç—Ä` | –ó–∞–º–µ—Ç–∫–∏ –æ —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–µ | –¢–µ–∫—Å—Ç |
| `–í—Ä–µ–º—è` | –í—Ä–µ–º—è –∏–∑–º–µ—Ä–µ–Ω–∏—è | –í—Ä–µ–º—è |
| `–ø–æ–∑–∂–µ/—Ä–∞–Ω—å—à–µ` | –ó–∞–º–µ—Ç–∫–∏ –æ –≤—Ä–µ–º–µ–Ω–∏ | –¢–µ–∫—Å—Ç |
| `–ø–ª–æ–¥–Ω—ã–π –ø–µ—Ä–∏–æ–¥` | –û—Ç–º–µ—Ç–∫–∏ –ø–ª–æ–¥–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ | –¢–µ–∫—Å—Ç |

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. –ò–º–ø–æ—Ä—Ç –∏–∑ Excel

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (–¥–∏–∞–ø–∞–∑–æ–Ω 35.0-40.0¬∞C)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π –∑–∞–º–µ—Ç–æ–∫
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL

### 2. –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel

- –í—ã–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç Excel
- –í–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

### 3. –®–∞–±–ª–æ–Ω—ã Excel

- –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Å—Ç—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
- –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
- –ì–æ—Ç–æ–≤—ã–µ –¥–Ω–∏ —Ü–∏–∫–ª–∞ (1-40)

### 4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
- –ê–Ω–∞–ª–∏–∑ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º –∏ –∑–∞–º–µ—Ç–∫–∞–º

## –ö–ª–∞—Å—Å—ã –∏ –º–µ—Ç–æ–¥—ã

### ExcelDataHandler

```python
class ExcelDataHandler:
    def load_excel_data() -> bool
    def extract_fertility_records() -> List[FertilityRecord]
    def save_to_database(user_id: int, records: List[FertilityRecord]) -> bool
    def get_statistics() -> Dict[str, Any]
    def export_to_bot_format(user_id: int) -> str
```

### FertilityRecord

```python
@dataclass
class FertilityRecord:
    cycle_day: Optional[int] = None
    date: Optional[date] = None
    temperature: Optional[float] = None
    temperature_alt: Optional[float] = None
    disruptions: Optional[str] = None
    note: Optional[str] = None
    # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
```

## Telegram –±–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

- `üìä Excel –∏–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç` - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Ä–∞–±–æ—Ç—ã —Å Excel
- `üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel` - –ë—ã—Å—Ç—Ä—ã–π —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- `üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å Excel —Ñ–∞–π–ª` - –ò–º–ø–æ—Ä—Ç –∏–∑ —Ñ–∞–π–ª–∞
- `üìÑ –°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω` - –ü–æ–ª—É—á–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

1. **handle_excel_import_button()** - –ü–æ–∫–∞–∑ –º–µ–Ω—é Excel –æ–ø–µ—Ä–∞—Ü–∏–π
2. **handle_document_upload()** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö Excel —Ñ–∞–π–ª–æ–≤
3. **handle_excel_template_download()** - –û—Ç–ø—Ä–∞–≤–∫–∞ —à–∞–±–ª–æ–Ω–∞
4. **handle_export_to_excel()** - –≠–∫—Å–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
pip install pandas openpyxl aiogram asyncpg python-dotenv
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
API_TOKEN=your_telegram_bot_token
DATABASE_URL=postgresql://user:password@host:port/database
```

### –ó–∞–ø—É—Å–∫

```bash
python updated_fertility_bot.py
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üìä Excel –∏–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç"
2. –í—ã–±–∏—Ä–∞–µ—Ç "üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å Excel —Ñ–∞–π–ª"
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Excel —Ñ–∞–π–ª (.xlsx)
4. –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–º–ø–æ—Ä—Ç–∞

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel"
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç Excel —Ñ–∞–π–ª —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "üìÑ –°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω"
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—É—Å—Ç–æ–π —à–∞–±–ª–æ–Ω Excel
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–∞–π–ª–æ–≤ (.xlsx, .xls)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 10MB)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö Excel —Ñ–∞–π–ª–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```sql
CREATE TABLE records (
    id SERIAL PRIMARY KEY,
    user_id BIGINT NOT NULL,
    record_date DATE NOT NULL,
    temperature DECIMAL(4,2),
    mucus_type VARCHAR(50),
    menstruation_type VARCHAR(50),
    cervical_position VARCHAR(50),
    note TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(user_id, record_date)
);
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏:

- `INFO` - –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `ERROR` - –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `DEBUG` - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö
- `WARNING` - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 10MB
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 35.0-40.0¬∞C
- –ú–∞–∫—Å–∏–º—É–º –∑–∞–ø–∏—Å–µ–π –≤ —ç–∫—Å–ø–æ—Ä—Ç–µ: 100 (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

## –ü—Ä–∏–º–µ—Ä Excel —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```
| –î–µ–Ω—å —Ü–∏–∫–ª–∞ | –î–∞—Ç–∞ | –ë–¢–¢   | –ù–∞—Ä—É—à–µ–Ω–∏—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ | –í—Ä–µ–º—è    |
|------------|------|-------|-----------|------------|----------|
| 1          | 9    | 36.50 |           |            | 05:00:00 |
| 2          | 10   | 36.50 |           |            | 05:30:00 |
| 3          | 11   | 36.45 | –ë–ù        | –ü–ª–æ—Ö–æ–π —Å–æ–Ω | 06:00:00 |
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –∞—É–¥–∏—Ç–∞